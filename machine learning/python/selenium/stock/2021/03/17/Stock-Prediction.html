<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Stock Price Prediction using Python | Shudi’s Data Science Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Stock Price Prediction using Python" />
<meta name="author" content="Shudi Zhao" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A step by step tutorial to predict the stock price of the most active stock using selenium &amp; machine learning." />
<meta property="og:description" content="A step by step tutorial to predict the stock price of the most active stock using selenium &amp; machine learning." />
<link rel="canonical" href="https://shudi-zhao.github.io/My_Data_Science_Blog/machine%20learning/python/selenium/stock/2021/03/17/Stock-Prediction.html" />
<meta property="og:url" content="https://shudi-zhao.github.io/My_Data_Science_Blog/machine%20learning/python/selenium/stock/2021/03/17/Stock-Prediction.html" />
<meta property="og:site_name" content="Shudi’s Data Science Blog" />
<meta property="og:image" content="https://shudi-zhao.github.io/My_Data_Science_Blog/images" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-17T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"https://shudi-zhao.github.io/My_Data_Science_Blog/machine%20learning/python/selenium/stock/2021/03/17/Stock-Prediction.html","@type":"BlogPosting","headline":"Stock Price Prediction using Python","dateModified":"2021-03-17T00:00:00-05:00","datePublished":"2021-03-17T00:00:00-05:00","image":"https://shudi-zhao.github.io/My_Data_Science_Blog/images","mainEntityOfPage":{"@type":"WebPage","@id":"https://shudi-zhao.github.io/My_Data_Science_Blog/machine%20learning/python/selenium/stock/2021/03/17/Stock-Prediction.html"},"author":{"@type":"Person","name":"Shudi Zhao"},"description":"A step by step tutorial to predict the stock price of the most active stock using selenium &amp; machine learning.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/My_Data_Science_Blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://shudi-zhao.github.io/My_Data_Science_Blog/feed.xml" title="Shudi's Data Science Blog" /><link rel="shortcut icon" type="image/x-icon" href="/My_Data_Science_Blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/My_Data_Science_Blog/">Shudi&#39;s Data Science Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/My_Data_Science_Blog/about/">About Me</a><a class="page-link" href="/My_Data_Science_Blog/search/">Search</a><a class="page-link" href="/My_Data_Science_Blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Stock Price Prediction using Python</h1><p class="page-description">A step by step tutorial to predict the stock price of the most active stock using selenium & machine learning.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-03-17T00:00:00-05:00" itemprop="datePublished">
        Mar 17, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Shudi Zhao</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      8 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/My_Data_Science_Blog/categories/#Machine Learning">Machine Learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/My_Data_Science_Blog/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/My_Data_Science_Blog/categories/#Selenium">Selenium</a>
        &nbsp;
      
        <a class="category-tags-link" href="/My_Data_Science_Blog/categories/#Stock">Stock</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/Shudi-Zhao/My_Data_Science_Blog/tree/master/_notebooks/2021-03-17-Stock-Prediction.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/My_Data_Science_Blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/Shudi-Zhao/My_Data_Science_Blog/master?filepath=_notebooks%2F2021-03-17-Stock-Prediction.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/My_Data_Science_Blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/Shudi-Zhao/My_Data_Science_Blog/blob/master/_notebooks/2021-03-17-Stock-Prediction.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/My_Data_Science_Blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-03-17-Stock-Prediction.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introduction">Introduction<a class="anchor-link" href="#Introduction"> </a></h1><p>In this tutorial, I will guide you throught how to predict the stock price of the most active stock based on the historical data.</p>
<p>Before we start, let me give you some basic ideal. First, we are going to use selenium for web scraping. We need to get the name of the most active stock on yahoo finance. Selenium is a hot tool not only in web scraping but also in automated web application test. If you haven't use selenium before, I recommend you to watch this fantanstic youtube <a href="https://www.youtube.com/watch?v=Xjv1sY630Uc">selenium tutorial</a> to set up selenium. And use this <a href="https://www.geeksforgeeks.org/selenium-python-tutorial/">selenium python tutorial</a> as more detailed reference. Then, we will get the historical data of that most active stock. Next, we will perform some prediction tasks using machine simple learning models. Finally, we can send our predictions to our clients by email.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/My_Data_Science_Blog/images/copied_from_nb/my_icons/Stock.jpg" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Prerequisites">Prerequisites<a class="anchor-link" href="#Prerequisites"> </a></h1><p>First, we need to import the necessary packages. Make sure you have installed all the packages below:</p>
<ul>
<li><a href="https://numpy.org/install/">numpy</a></li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html">pandas</a></li>
<li><a href="https://matplotlib.org/stable/users/installing.html">matplotlib</a></li>
<li><a href="https://scikit-learn.org/stable/install.html">sklearn</a></li>
<li><a href="https://pypi.org/project/iexfinance/">iexfinance</a></li>
<li><a href="https://pypi.org/project/selenium/">selenium</a></li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">smtplib</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1">#For Prediction</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span><span class="c1">#,cross_validation this is no longer aviliable</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> <span class="c1">#use this instead</span>
<span class="c1">#For Stock Data</span>
<span class="kn">from</span> <span class="nn">iexfinance.stocks</span> <span class="kn">import</span> <span class="n">get_historical_data</span>
<span class="kn">from</span> <span class="nn">iexfinance.refdata</span> <span class="kn">import</span> <span class="n">get_symbols</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">copy</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Get-Stock-Name">Get Stock Name<a class="anchor-link" href="#Get-Stock-Name"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, we need to create our chrome drive then use driver.get(url) navigate to our desired webpage: <a href="https://finance.yahoo.com/most-active">https://finance.yahoo.com/most-active</a> which will display the top 25 most active stocks in this page. If you are interested in other stocks you can change this link to the URL you want. Inside webdriver.Chrome() you will need to type your chromedriver path.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span>
    <span class="s1">&#39;Type the directory of your chromedriver here&#39;</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://finance.yahoo.com/most-active&quot;</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we want to find the xpath of the most active stock name. You can follow the following steps to get the xpath:</p>
<p>First, go to your desired webpage and inspect the element of that webpage.</p>
<p>Click the "Select an Element" button:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/My_Data_Science_Blog/images/copied_from_nb/my_icons/SelectElement.png" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Click on the first ticker:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/My_Data_Science_Blog/images/copied_from_nb/my_icons/ClickTicker.png" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, copy the xpath following the instruction below:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/My_Data_Science_Blog/images/copied_from_nb/my_icons/Xpath.png" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After you find the xpath, you can get the element use the code below:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ticker</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
    <span class="s1">&#39;//*[@id=&quot;scr-res-table&quot;]/div[1]/table/tbody/tr[1]/td[1]/a&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Last, we want to get the stock name by calling ticker.text, and make a deep copy, because we will lose the stock name after we call <strong>driver.quit()</strong>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stock</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we successfully scraped the stock name of the most active stock using selenium. Below is the name we got from the yahoo finance:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stock</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;SNDL&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Get-Historical-Data">Get Historical Data<a class="anchor-link" href="#Get-Historical-Data"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we can get the historical data for the most active stock. Inside the get_historical_data(), you will need to set the start and end date, the output format (we will use pandas in this project).</p>
<p>For the token, you will need to visit <a href="https://iexcloud.io/cloud-login#/register">iexcloud</a> to create an account to get your API token. You can choose the free version, but it only offers you a very limited access.</p>
<p>Last, we will save the historical data into a csv file.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#Download Historical stock data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">get_historical_data</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">&#39;pandas&#39;</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="s2">&quot;pk_422a359c341b427ea05864740c233fe3&quot;</span><span class="p">)</span>
<span class="n">csv_name</span> <span class="o">=</span> <span class="p">(</span> <span class="n">stock</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csv_name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Your dataframe should look like this:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>close</th>
      <th>high</th>
      <th>low</th>
      <th>open</th>
      <th>symbol</th>
      <th>volume</th>
      <th>id</th>
      <th>key</th>
      <th>subkey</th>
      <th>...</th>
      <th>uLow</th>
      <th>uVolume</th>
      <th>fOpen</th>
      <th>fClose</th>
      <th>fHigh</th>
      <th>fLow</th>
      <th>fVolume</th>
      <th>label</th>
      <th>change</th>
      <th>changePercent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2020-03-02</td>
      <td>1.48</td>
      <td>1.540</td>
      <td>1.40</td>
      <td>1.44</td>
      <td>SNDL</td>
      <td>1056600</td>
      <td>HISTORICAL_PRICES</td>
      <td>SNDL</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.40</td>
      <td>1056600</td>
      <td>1.44</td>
      <td>1.48</td>
      <td>1.540</td>
      <td>1.40</td>
      <td>1056600</td>
      <td>Mar 2, 20</td>
      <td>0.06</td>
      <td>0.0423</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2020-03-03</td>
      <td>1.48</td>
      <td>1.500</td>
      <td>1.35</td>
      <td>1.45</td>
      <td>SNDL</td>
      <td>945902</td>
      <td>HISTORICAL_PRICES</td>
      <td>SNDL</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.35</td>
      <td>945902</td>
      <td>1.45</td>
      <td>1.48</td>
      <td>1.500</td>
      <td>1.35</td>
      <td>945902</td>
      <td>Mar 3, 20</td>
      <td>0.00</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2020-03-04</td>
      <td>1.65</td>
      <td>1.700</td>
      <td>1.47</td>
      <td>1.50</td>
      <td>SNDL</td>
      <td>1522873</td>
      <td>HISTORICAL_PRICES</td>
      <td>SNDL</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.47</td>
      <td>1522873</td>
      <td>1.50</td>
      <td>1.65</td>
      <td>1.700</td>
      <td>1.47</td>
      <td>1522873</td>
      <td>Mar 4, 20</td>
      <td>0.17</td>
      <td>0.1149</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2020-03-05</td>
      <td>1.45</td>
      <td>1.650</td>
      <td>1.44</td>
      <td>1.60</td>
      <td>SNDL</td>
      <td>673430</td>
      <td>HISTORICAL_PRICES</td>
      <td>SNDL</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.44</td>
      <td>673430</td>
      <td>1.60</td>
      <td>1.45</td>
      <td>1.650</td>
      <td>1.44</td>
      <td>673430</td>
      <td>Mar 5, 20</td>
      <td>-0.20</td>
      <td>-0.1212</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2020-03-06</td>
      <td>1.33</td>
      <td>1.475</td>
      <td>1.33</td>
      <td>1.45</td>
      <td>SNDL</td>
      <td>494977</td>
      <td>HISTORICAL_PRICES</td>
      <td>SNDL</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.33</td>
      <td>494977</td>
      <td>1.45</td>
      <td>1.33</td>
      <td>1.475</td>
      <td>1.33</td>
      <td>494977</td>
      <td>Mar 6, 20</td>
      <td>-0.12</td>
      <td>-0.0828</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Modeling">Modeling<a class="anchor-link" href="#Modeling"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before modeling, we need to clean our data a little bit. First, we will select the useful features, because there are too many columns in this dataframe. Then, add the prediction column.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#read the data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_name</span><span class="p">)</span>
<span class="c1">#feature selection</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">,</span><span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="s1">&#39;change&#39;</span><span class="p">]]</span>
<span class="c1">#add a prediction column (eg: today&#39;s prediction is the close price of tomorrow)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#drop the last row, because the value in the prediction column is nan</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Your new data frame will look like this:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>close</th>
      <th>high</th>
      <th>low</th>
      <th>open</th>
      <th>volume</th>
      <th>change</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.48</td>
      <td>1.540</td>
      <td>1.40</td>
      <td>1.440</td>
      <td>1056600</td>
      <td>0.06</td>
      <td>1.48</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.48</td>
      <td>1.500</td>
      <td>1.35</td>
      <td>1.450</td>
      <td>945902</td>
      <td>0.00</td>
      <td>1.65</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.65</td>
      <td>1.700</td>
      <td>1.47</td>
      <td>1.500</td>
      <td>1522873</td>
      <td>0.17</td>
      <td>1.45</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.45</td>
      <td>1.650</td>
      <td>1.44</td>
      <td>1.600</td>
      <td>673430</td>
      <td>-0.20</td>
      <td>1.33</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.33</td>
      <td>1.475</td>
      <td>1.33</td>
      <td>1.450</td>
      <td>494977</td>
      <td>-0.12</td>
      <td>1.22</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>246</td>
      <td>1.43</td>
      <td>1.600</td>
      <td>1.40</td>
      <td>1.425</td>
      <td>255266388</td>
      <td>-0.10</td>
      <td>1.26</td>
    </tr>
    <tr>
      <td>247</td>
      <td>1.26</td>
      <td>1.330</td>
      <td>1.10</td>
      <td>1.290</td>
      <td>397249358</td>
      <td>-0.17</td>
      <td>1.45</td>
    </tr>
    <tr>
      <td>248</td>
      <td>1.45</td>
      <td>1.470</td>
      <td>1.28</td>
      <td>1.320</td>
      <td>433296256</td>
      <td>0.19</td>
      <td>1.37</td>
    </tr>
    <tr>
      <td>249</td>
      <td>1.37</td>
      <td>1.640</td>
      <td>1.36</td>
      <td>1.540</td>
      <td>391487356</td>
      <td>-0.08</td>
      <td>1.33</td>
    </tr>
    <tr>
      <td>250</td>
      <td>1.33</td>
      <td>1.490</td>
      <td>1.31</td>
      <td>1.390</td>
      <td>255416545</td>
      <td>-0.04</td>
      <td>1.35</td>
    </tr>
  </tbody>
</table>
<p>251 rows × 7 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we will built our regression model, a detailed explaination is commented below:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#X is the predictor variable, Y is the target variable</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;prediction&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">])</span>
<span class="c1">#Nomalize our predictor variables</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1">#the last row in the predictor variable</span>
<span class="n">X_prediction</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
<span class="c1">#the last row in the target variable</span>
<span class="n">Y_ans</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>

<span class="c1">#Delete the last row in X and Y, because we don&#39;t want it to be in the train data. </span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1">#Split our data into train and test data</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1">#Performing the Regression on the training data</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="c1">#Predict the closing price of X_prediction</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_prediction</span><span class="p">))</span>
<span class="c1">#Accuracy score of our model</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Last, we can write a function to send result to our clients. The smtplib module allowed you to send emails to any internet machine with an SMTP. Check more details for <a href="https://docs.python.org/3/library/smtplib.html">SMTP</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sendMessage</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="c1"># If you&#39;re using Gmail to send the message, you might need to </span>
    <span class="c1"># go into the security settings of your email account and </span>
    <span class="c1"># enable the &quot;Allow less secure apps&quot; option </span>
    <span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;Your Email Address&quot;</span>
    <span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;The password of your email&quot;</span>
    
    <span class="n">to</span> <span class="o">=</span> <span class="s2">&quot;the email you will sent to ...@gmail.com&quot;</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">text</span>

    <span class="n">Subject</span> <span class="o">=</span> <span class="s2">&quot;Stock Prediction&quot;</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Subject: </span><span class="si">{}</span><span class="se">\n\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    
    <span class="n">server</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="s1">&#39;smtp.gmail.com&#39;</span><span class="p">,</span> <span class="mi">587</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">starttls</span><span class="p">()</span>
    <span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">sendmail</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sent&#39;</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Stock: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stock</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Close Price on &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">]],</span> <span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;: $&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="s1">&#39;close&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Prediction for the next day closing: $</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span>
<span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Actuall closing: $</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Y_ans</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Model Accuracy: </span><span class="si">%.2f%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">result</span><span class="o">*</span><span class="mf">100.0</span><span class="p">))</span>

<span class="n">sendMessage</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The email will be in this format:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/My_Data_Science_Blog/images/copied_from_nb/my_icons/email.png" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Final-Application">Final Application<a class="anchor-link" href="#Final-Application"> </a></h1><p>Finally, we can add everything up to a complete application. The following code will do the job:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-show</span>
<span class="c1"># Final application </span>
<span class="k">def</span> <span class="nf">getStocks</span><span class="p">():</span>
    <span class="c1">#Navigating to the Yahoo stock screener</span>
    
    <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span>
        <span class="s1">&#39;Type the directory of your chromedriver here&#39;</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://finance.yahoo.com/most-active&quot;</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="c1">#Creating a stock list and iterating through the ticker names on the stock screener list</span>
    <span class="c1">#Xpath: //*[@id=&quot;scr-res-table&quot;]/div[1]/table/tbody/tr[1]/td[1]/a</span>
    <span class="n">ticker</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
        <span class="s1">&#39;//*[@id=&quot;scr-res-table&quot;]/div[1]/table/tbody/tr[1]/td[1]/a&#39;</span><span class="p">)</span>

    <span class="c1">#stock = ticker.text</span>
    <span class="n">stock</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    
    <span class="n">driver</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">predictData</span><span class="p">(</span><span class="n">stock</span><span class="p">)</span>
    

        
<span class="k">def</span> <span class="nf">sendMessage</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="c1"># If you&#39;re using Gmail to send the message, you might need to </span>
    <span class="c1"># go into the security settings of your email account and </span>
    <span class="c1"># enable the &quot;Allow less secure apps&quot; option </span>
    <span class="n">username</span> <span class="o">=</span> <span class="s2">&quot;Your Email Address&quot;</span>
    <span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;The password of your email&quot;</span>
    
    <span class="n">to</span> <span class="o">=</span> <span class="s2">&quot;the email you will sent to ...@gmail.com&quot;</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">text</span>

    <span class="n">Subject</span> <span class="o">=</span> <span class="s2">&quot;Stock Prediction&quot;</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Subject: </span><span class="si">{}</span><span class="se">\n\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Subject</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    
    <span class="n">server</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="s1">&#39;smtp.gmail.com&#39;</span><span class="p">,</span> <span class="mi">587</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">starttls</span><span class="p">()</span>
    <span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">sendmail</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sent&#39;</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">predictData</span><span class="p">(</span><span class="n">stock</span><span class="p">):</span>
    
    <span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">get_historical_data</span><span class="p">(</span><span class="n">stock</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s1">&#39;pandas&#39;</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="s2">&quot;pk_422a359c341b427ea05864740c233fe3&quot;</span><span class="p">)</span> 
    <span class="n">csv_name</span> <span class="o">=</span> <span class="p">(</span> <span class="n">stock</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csv_name</span><span class="p">)</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_name</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">,</span><span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="s1">&#39;change&#39;</span><span class="p">]]</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">#Predicting the Stock price in the future</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;prediction&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">])</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">X_prediction</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">Y_ans</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

    <span class="c1">#Performing the Regression on the training data</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_prediction</span><span class="p">))</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Stock: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stock</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Close Price on &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">]],</span> <span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;: $&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="s1">&#39;close&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Prediction for tomorrow closing: $</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span>
    <span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Actuall closing: $</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Y_ans</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Model Accuracy: </span><span class="si">%.2f%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">result</span><span class="o">*</span><span class="mf">100.0</span><span class="p">))</span>

    <span class="n">sendMessage</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">getStocks</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thank you all for reading it, I hope this tutorial will benifit you. If you have any questions feel free to comment below. Good luck everyone!</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="Shudi-Zhao/My_Data_Science_Blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/My_Data_Science_Blog/machine%20learning/python/selenium/stock/2021/03/17/Stock-Prediction.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/My_Data_Science_Blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/My_Data_Science_Blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/My_Data_Science_Blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/My_Data_Science_Blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/My_Data_Science_Blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
